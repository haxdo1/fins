<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Activity Report BBCode Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-200 min-h-screen p-6">

<div class="max-w-6xl mx-auto">

  <!-- HEADER -->
  <div class="mb-8 text-center">
    <h1 class="text-3xl font-bold text-white">Activity Report BBCode Generator</h1>
    <p class="text-slate-400 mt-2">Each card equals one activity report</p>
  </div>

  <!-- IDENTITY -->
  <div class="bg-slate-800 border border-slate-700 rounded-xl p-6 mb-6">
    <h2 class="text-xl font-semibold mb-4">Staff Identity</h2>
    <div class="grid md:grid-cols-2 gap-4">
      <input id="name" class="p-2 rounded bg-slate-900 border border-slate-700" placeholder="Full Name">
      <input id="rank" class="p-2 rounded bg-slate-900 border border-slate-700" placeholder="Current Rank">
    </div>
  </div>

  <!-- REPORT CARDS -->
  <div id="reportContainer" class="space-y-6"></div>

  <!-- ADD CARD -->
  <button onclick="addCard()" class="w-full bg-indigo-600 hover:bg-indigo-700 p-3 rounded-lg font-semibold mb-6">
    âž• Add Report Card
  </button>

  <!-- ACTIONS -->
  <div class="flex gap-4 mb-6">
    <button onclick="generateBBCode()" class="flex-1 bg-blue-600 hover:bg-blue-700 p-3 rounded-lg font-semibold">
      Generate BBCode
    </button>
    <button onclick="copyBBCode()" class="flex-1 bg-emerald-600 hover:bg-emerald-700 p-3 rounded-lg font-semibold">
      Copy BBCode
    </button>
  </div>

  <!-- OUTPUT -->
  <textarea id="output" class="w-full h-96 bg-slate-900 border border-slate-700 rounded-xl p-4 font-mono text-sm" readonly></textarea>

</div>

<script>
let cardCount = 0;

/* WEEK RANGE */
function getMonthWeekRange(date = new Date()) {
  const start = (date.getMonth() * 5) + 1;
  return { start, end: start + 4 };
}

/* ADD CARD */
function addCard() {
  cardCount++;
  const card = document.createElement('div');
  card.className = "bg-slate-800 border border-slate-700 rounded-xl p-6";
  card.innerHTML = `
    <h3 class="text-lg font-semibold mb-4">Report #${cardCount}</h3>

    <p class="text-sm text-slate-400 mb-2">Reimbursement</p>
    <input class="w-full mb-2 p-2 rounded bg-slate-900 border border-slate-700 reim-r" placeholder="Received URL">
    <input class="w-full mb-2 p-2 rounded bg-slate-900 border border-slate-700 reim-a" placeholder="Accepted URL">
    <input class="w-full mb-4 p-2 rounded bg-slate-900 border border-slate-700 reim-f" placeholder="Fund Given URL">

    <p class="text-sm text-slate-400 mb-2">Proposal</p>
    <input class="w-full mb-2 p-2 rounded bg-slate-900 border border-slate-700 prop-r" placeholder="Received URL">
    <input class="w-full mb-2 p-2 rounded bg-slate-900 border border-slate-700 prop-a" placeholder="Accepted URL">
    <input class="w-full p-2 rounded bg-slate-900 border border-slate-700 prop-f" placeholder="Fund Given URL">
  `;
  document.getElementById('reportContainer').appendChild(card);
}

/* ITEM */
function item(url, text) {
  return url ? `[*][url=${url}]${text}[/url]\n` : '';
}

/* GENERATE */
function generateBBCode() {
  const name = name.value || '-';
  const rank = rank.value || '-';
  const week = getMonthWeekRange();

  let reimbursement = '';
  let proposal = '';

  document.querySelectorAll('#reportContainer > div').forEach(card => {
    reimbursement +=
      item(card.querySelector('.reim-r').value, 'Received Reimbursement') +
      item(card.querySelector('.reim-a').value, 'Accepted Reimbursement') +
      item(card.querySelector('.reim-f').value, 'Fund Has Been Given');

    proposal +=
      item(card.querySelector('.prop-r').value, 'Received Proposal') +
      item(card.querySelector('.prop-a').value, 'Accepted Proposal') +
      item(card.querySelector('.prop-f').value, 'Fund Has Been Given');
  });

  output.value = `[divbox=darkblue][divbox=white]

[center][img]https://news.san-andreas.net/download/file.php?avatar=g69_1637211788.png[/img][/center]
[hr][/hr]
[divbox=darkblue][color=#FFFFFF][center][size=150][b]Financial Regulator Activity Report[/b][/size][/center][/color][/divbox]
[hr][/hr]
[b]Name[/b] : ${name}
[b]Current Rank[/b] : ${rank}
[b]Week[/b] : Week #${week.start} - Week #${week.end}

[b]Report:[/b]
[secspoiler=Reimbursement]
[list=1]
${reimbursement}[/list]
[/secspoiler]

[secspoiler=Proposal]
[list=1]
${proposal}[/list]
[/secspoiler]`;
}

/* COPY */
function copyBBCode() {
  if (!output.value) return;
  navigator.clipboard.writeText(output.value);
  alert('BBCode copied!');
}

/* INIT */
addCard();
</script>

</body>
</html>
