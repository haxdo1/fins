<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Laporan Generator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        font-family: Inter, system-ui, sans-serif;
        background: #f4f6f8;
        margin: 0;
        padding: 30px;
        color: #1f2937;
    }

    h1 {
        margin-bottom: 20px;
    }

    .controls {
        display: flex;
        gap: 12px;
        margin-bottom: 25px;
    }

    button {
        padding: 10px 16px;
        border: none;
        border-radius: 8px;
        background: #2563eb;
        color: white;
        font-weight: 600;
        cursor: pointer;
    }

    button.secondary {
        background: #10b981;
    }

    .card {
        background: white;
        border-radius: 14px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .badge {
        padding: 6px 12px;
        border-radius: 999px;
        font-size: 12px;
        font-weight: 600;
        background: #e5e7eb;
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 14px;
    }

    input, select {
        width: 100%;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
        font-size: 14px;
    }

    .output {
        margin-top: 15px;
        background: #0f172a;
        color: #e5e7eb;
        padding: 14px;
        border-radius: 10px;
        font-family: monospace;
        font-size: 13px;
        word-break: break-word;
    }

    .remove {
        background: #ef4444;
    }
</style>
</head>

<body>

<h1>Laporan Generator</h1>

<div class="controls">
    <button onclick="addCard('reimbursement')">+ Reimbursement</button>
    <button class="secondary" onclick="addCard('proposal')">+ Proposal</button>
</div>

<div id="cards"></div>

<script>
let cardId = 0;

function getWeekAndMonth() {
    const now = new Date();
    const start = new Date(now.getFullYear(), 0, 1);
    const diff = now - start;
    const week = Math.ceil(((diff / 86400000) + start.getDay() + 1) / 7);
    const month = now.toLocaleString('en-US', { month: 'long' });
    const year = now.getFullYear();
    return { week, month, year };
}

function addCard(type) {
    cardId++;
    const { week, month, year } = getWeekAndMonth();

    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.type = type;

    card.innerHTML = `
        <div class="card-header">
            <strong>${type === 'reimbursement' ? 'Reimbursement' : 'Proposal'}</strong>
            <button class="remove" onclick="this.closest('.card').remove()">Remove</button>
        </div>

        <div class="grid">
            <input placeholder="Name" class="name">
            ${type === 'proposal' ? `<input placeholder="Proposal Type (e.g CC Salary March ${year})" class="ptype">` : ''}
            <input placeholder="Link" class="link">
            <select class="status">
                <option value="RECEIVED">RECEIVED</option>
                <option value="ACCEPTED">ACCEPTED</option>
                <option value="FUNDS HAVE BEEN GIVEN">FUNDS HAVE BEEN GIVEN</option>
            </select>
        </div>

        <div class="output"></div>
    `;

    document.getElementById('cards').appendChild(card);

    card.querySelectorAll('input, select').forEach(el => {
        el.addEventListener('input', () => updateOutput(card, week, month, year));
        el.addEventListener('change', () => updateOutput(card, week, month, year));
    });

    updateOutput(card, week, month, year);
}

function updateOutput(card, week, month, year) {
    const type = card.dataset.type;
    const name = card.querySelector('.name').value || '-';
    const link = card.querySelector('.link').value || '-';
    const status = card.querySelector('.status').value;
    const ptype = card.querySelector('.ptype')?.value || '';

    let text = '';

    if (type === 'reimbursement') {
        text = `[${status}] Reimbursement ${name} (Week ${week} / ${month})`;
    } else {
        text = `[PROPOSAL] ${name} - ${ptype} - ${status}`;
    }

    card.querySelector('.output').innerHTML = `
${text}
Link: ${link}
`;
}
</script>

</body>
</html>
