<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Activity Report BBCode Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-200 min-h-screen p-6">

<div class="max-w-6xl mx-auto">

  <!-- HEADER -->
  <div class="mb-8 text-center">
    <h1 class="text-3xl font-bold text-white">Activity Report BBCode Generator</h1>
    <p class="text-slate-400 mt-2">
      Reimbursement and Proposal are standalone reports
    </p>
  </div>

  <!-- IDENTITY -->
  <div class="bg-slate-800 border border-slate-700 rounded-xl p-6 mb-6">
    <h2 class="text-xl font-semibold mb-4">Staff Identity</h2>
    <div class="grid md:grid-cols-2 gap-4">
      <input id="name" class="p-2 rounded bg-slate-900 border border-slate-700" placeholder="Full Name">
      <input id="rank" class="p-2 rounded bg-slate-900 border border-slate-700" placeholder="Current Rank">
    </div>
  </div>

  <!-- REIMBURSEMENT -->
  <div class="mb-8">
    <div class="flex justify-between items-center mb-3">
      <h2 class="text-xl font-semibold">Reimbursement Reports</h2>
      <button onclick="addReim()" class="bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded">
        ➕ Add Reimbursement
      </button>
    </div>
    <div id="reimContainer" class="space-y-4"></div>
  </div>

  <!-- PROPOSAL -->
  <div class="mb-8">
    <div class="flex justify-between items-center mb-3">
      <h2 class="text-xl font-semibold">Proposal Reports</h2>
      <button onclick="addProp()" class="bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded">
        ➕ Add Proposal
      </button>
    </div>
    <div id="propContainer" class="space-y-4"></div>
  </div>

  <!-- ACTION -->
  <div class="flex gap-4 mb-6">
    <button onclick="generateBBCode()" class="flex-1 bg-blue-600 hover:bg-blue-700 p-3 rounded-lg font-semibold">
      Generate BBCode
    </button>
    <button onclick="copyBBCode()" class="flex-1 bg-emerald-600 hover:bg-emerald-700 p-3 rounded-lg font-semibold">
      Copy BBCode
    </button>
  </div>

  <!-- OUTPUT -->
  <textarea id="output" class="w-full h-96 bg-slate-900 border border-slate-700 rounded-xl p-4 font-mono text-sm" readonly></textarea>

</div>

<script>
/* ================= WEEK RANGE ================= */
function getMonthWeekRange(date = new Date()) {
  const start = (date.getMonth() * 5) + 1;
  return { start, end: start + 4 };
}

/* ================= HELPERS ================= */
function item(url, label) {
  return url ? `[*][url=${url}]${label}[/url]\n` : '';
}

function createCard(type, index) {
  return `
  <div class="bg-slate-800 border border-slate-700 rounded-xl p-5">
    <h3 class="font-semibold mb-3">${type} #${index}</h3>
    <input class="w-full mb-2 p-2 rounded bg-slate-900 border border-slate-700 received" placeholder="Received URL">
    <input class="w-full mb-2 p-2 rounded bg-slate-900 border border-slate-700 accepted" placeholder="Accepted URL">
    <input class="w-full p-2 rounded bg-slate-900 border border-slate-700 fund" placeholder="Fund Has Been Given URL">
  </div>`;
}

/* ================= ADD CARD ================= */
let reimCount = 0, propCount = 0;

function addReim() {
  reimCount++;
  reimContainer.insertAdjacentHTML('beforeend', createCard('Reimbursement', reimCount));
}

function addProp() {
  propCount++;
  propContainer.insertAdjacentHTML('beforeend', createCard('Proposal', propCount));
}

/* ================= GENERATE ================= */
function generateBBCode() {
  const week = getMonthWeekRange();

  let reimbursement = '';
  document.querySelectorAll('#reimContainer > div').forEach(card => {
    reimbursement +=
      item(card.querySelector('.received').value, 'Received Reimbursement') +
      item(card.querySelector('.accepted').value, 'Accepted Reimbursement') +
      item(card.querySelector('.fund').value, 'Fund Has Been Given');
  });

  let proposal = '';
  document.querySelectorAll('#propContainer > div').forEach(card => {
    proposal +=
      item(card.querySelector('.received').value, 'Received Proposal') +
      item(card.querySelector('.accepted').value, 'Accepted Proposal') +
      item(card.querySelector('.fund').value, 'Fund Has Been Given');
  });

  output.value = `[divbox=darkblue][divbox=white]

[center][img]https://news.san-andreas.net/download/file.php?avatar=g69_1637211788.png[/img][/center]
[hr][/hr]
[divbox=darkblue][color=#FFFFFF][center][size=150][b]Financial Regulator Activity Report[/b][/size][/center][/color][/divbox]
[hr][/hr]
[b]Name[/b] : ${name.value || '-'}
[b]Current Rank[/b] : ${rank.value || '-'}
[b]Week[/b] : Week #${week.start} - Week #${week.end}

[b]Report:[/b]
[secspoiler=Reimbursement]
[list=1]
${reimbursement || '[*]No reimbursement activity'}
[/list]
[/secspoiler]

[secspoiler=Proposal]
[list=1]
${proposal || '[*]No proposal activity'}
[/list]
[/secspoiler]`;
}

/* ================= COPY ================= */
function copyBBCode() {
  if (!output.value) return;
  navigator.clipboard.writeText(output.value);
  alert('BBCode copied successfully!');
}

/* INIT */
addReim();
addProp();
</script>

</body>
</html>
